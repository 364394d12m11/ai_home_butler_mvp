<view class="page" wx:if="{{!loading}}">
  <!-- èœå“å¤´å›¾åŒºåŸŸ -->
  <view class="dish-header">
    <view class="dish-emoji">{{dish.emoji || 'ğŸ½ï¸'}}</view>
    <view class="dish-info">
      <text class="dish-name">{{dish.name}}</text>
      <view class="dish-meta">
        <text class="meta-item">â±ï¸ {{estimatedTime}}åˆ†é’Ÿ</text>
        <text class="meta-item">ğŸ’° {{dish.costLabel}}</text>
        <text class="meta-item" wx:if="{{dish.spicy > 0}}">ğŸŒ¶ï¸ {{dish.spicyLabel}}</text>
      </view>
      <view class="dish-tags">
        <text class="tag" wx:for="{{tags}}" wx:key="*this">{{item}}</text>
      </view>
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="action-btn favorite-btn {{favorited ? 'favorited' : ''}}" 
              bindtap="toggleFavorite">
        {{favorited ? 'â¤ï¸' : 'ğŸ¤'}}
      </button>
      <button class="action-btn share-btn" bindtap="shareDish">ğŸ“¤</button>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="quick-actions">
    <button class="quick-btn video-btn" bindtap="watchVideo">
      <text class="btn-icon">ğŸ“º</text>
      <text class="btn-text">è§‚çœ‹è§†é¢‘</text>
    </button>
    <button class="quick-btn menu-btn" bindtap="addToTodayMenu">
      <text class="btn-icon">â•</text>
      <text class="btn-text">åŠ å…¥èœå•</text>
    </button>
    <button class="quick-btn shopping-btn" bindtap="generateShoppingList">
      <text class="btn-icon">ğŸ›’</text>
      <text class="btn-text">ç”Ÿæˆæ¸…å•</text>
    </button>
  </view>

  <!-- è¥å…»ä¿¡æ¯ -->
  <view class="section nutrition-section" wx:if="{{dish.nutritionInfo}}">
    <view class="section-title">è¥å…»ä¿¡æ¯</view>
    <view class="nutrition-grid">
      <view class="nutrition-item">
        <text class="nutrition-label">çƒ­é‡</text>
        <text class="nutrition-value">{{dish.nutritionInfo.calories}}</text>
      </view>
      <view class="nutrition-item">
        <text class="nutrition-label">è›‹ç™½è´¨</text>
        <text class="nutrition-value">{{dish.nutritionInfo.protein}}</text>
      </view>
      <view class="nutrition-item">
        <text class="nutrition-label">çº¤ç»´</text>
        <text class="nutrition-value">{{dish.nutritionInfo.fiber}}</text>
      </view>
      <view class="nutrition-item">
        <text class="nutrition-label">è„‚è‚ª</text>
        <text class="nutrition-value">{{dish.nutritionInfo.fat}}</text>
      </view>
    </view>
  </view>

  <!-- ç”¨æ–™æ¸…å• -->
  <view class="section ingredients-section">
    <view class="section-title">
      <text>ğŸ¥˜ ç”¨æ–™</text>
      <text class="ingredient-count">{{ingredients.length}}ç§</text>
    </view>
    <view class="ingredients-list">
      <view class="ingredient-item" wx:for="{{ingredients}}" wx:key="*this">
        <text class="ingredient-name">{{item}}</text>
        <text class="ingredient-spec">é€‚é‡</text>
      </view>
    </view>
  </view>

  <!-- åˆ¶ä½œæ­¥éª¤ -->
  <view class="section steps-section">
    <view class="section-title">
      <text>ğŸ“ åˆ¶ä½œæ­¥éª¤</text>
      <text class="steps-count">{{steps.length}}æ­¥</text>
    </view>
    <view class="steps-list">
      <view class="step-item" wx:for="{{steps}}" wx:key="*this" wx:for-index="index">
        <view class="step-number">{{index + 1}}</view>
        <text class="step-content">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- åˆ¶ä½œæç¤º -->
  <view class="section tips-section" wx:if="{{tips.length > 0}}">
    <view class="section-title tips-header" bindtap="toggleTips">
      <text>ğŸ’¡ åˆ¶ä½œæç¤º</text>
      <text class="expand-icon {{showTips ? 'expanded' : ''}}">â–¼</text>
    </view>
    <view class="tips-list {{showTips ? 'show' : ''}}">
      <view class="tip-item" wx:for="{{tips}}" wx:key="*this">
        <text class="tip-content">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- ç›¸å…³æ¨è -->
  <view class="section related-section" wx:if="{{relatedDishes.length > 0}}">
    <view class="section-title">ğŸ”— ç›¸å…³æ¨è</view>
    <view class="related-dishes">
      <view class="related-dish" 
            wx:for="{{relatedDishes}}" wx:key="id"
            bindtap="viewRelatedDish" data-id="{{item.id}}">
        <text class="related-emoji">{{item.emoji}}</text>
        <text class="related-name">{{item.name}}</text>
        <text class="related-time">{{item.time}}åˆ†é’Ÿ</text>
      </view>
    </view>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading-container" wx:if="{{loading}}">
  <view class="loading-spinner"></view>
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>